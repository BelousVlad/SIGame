<h1>Lobby</h1>
<div class="container">
	<div class="master-container"></div>
	<div class="game-info-container"></div>
	<div class="chat-container"></div>
	<input type="file" class="select-pack">select pack</input>
	<button class="game-start-btn">start</button>
	<button class="get-round">get round</button>
	<button class="next-round-btn">next round</button>
	<button class="previous-round-btn">previous round</button>
</div>
<div class="main-canvas">question table</div>
<div class="container">player-container</div>
<div class="container">
	<div class="players-container">

	<!--
	<div class="player-box">
		<img class="player-box-img">
		<div class="player-box-name"></div>
		<div class="player-box-score"></div>
	</div>
	-->
	</div>
</div>

<div class="container">
	<textarea id="chat_send_text">
		
	</textarea>
	<input type="button" name="chat_send_btn" value="Chat">	
</div>

<div class="container">
	<div class="chat">
	<!--
		<div class="chat-message">
			<span class="chat-message-from"></span>
			<span>: </span>
			<span class="chat-message-text"></span>
		</div>
	-->
	</div>
</div>

<script type="text/javascript">

	$("input[name=chat_send_btn]").click(function(e){
		let text = $('#chat_send_text').val().trim();

		if (text)
		{
			app.speakerctrl.sendChatMessage(text);
		}
	})

	$(document).on('click','.host-player-menu-kick',function(e){

		let name = $(event.target).parent().parent().attr("name");
		app.kick_player(name);

	});

	$(document).on('click','.host-player-menu-change-score',function(e){

		let name = $(event.target).parent().parent().attr("name");

		app.view_model.viewChangeScorePopup().
			then(function(obj) {
				let score = obj.score;

				app.lobbyChangePlayerScore(name, score);
			})

	});

	document.querySelector('.select-pack').onchange = function( file ) {
		var formData = new FormData(),
			request = new XMLHttpRequest();
		formData.append('userfile', document.querySelector('.select-pack').files[0] );
		formData.append('CustomField', 'test');
		request.open('POST', 'api/upload/pack');
		request.send(formData);

	}

	document.querySelector('.game-start-btn').onclick = function ( ) {
		app.speakerctrl.startGame();
	}

	document.querySelector('.get-round').onclick = function ( ) {
		app.speakerctrl.getRound();
	}

	document.querySelector('.next-round-btn').onclick = function ( ) {
		app.speakerctrl.nextRound();
	}

	document.querySelector('.previous-round-btn').onclick = function ( ) {
		app.speakerctrl.previousRound();
	}

</script>